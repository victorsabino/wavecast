<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="/src/styles.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tauri App</title>
    <script type="module" src="/src/main.ts" defer></script>
  </head>

  <body>
    <main class="container">
      <div class="video-metadata-section">
        <h3>Video Details</h3>
        <div class="form-group">
          <label for="video-title">Video Title</label>
          <input type="text" id="video-title" placeholder="My Awesome Video" value="Converted Video">
        </div>
        <div class="form-group">
          <label for="video-description">Description (Optional)</label>
          <textarea id="video-description" rows="3" placeholder="Enter video description..."></textarea>
        </div>
      </div>

      <div class="upload-section">
        <div class="upload-card">
          <div class="upload-header">
            <h2>Background</h2>
          </div>
          <div class="background-type-selector">
            <label>
              <input type="radio" name="bg-type" value="image" checked id="bg-type-image">
              Image
            </label>
            <label>
              <input type="radio" name="bg-type" value="color" id="bg-type-color">
              Solid Color
            </label>
          </div>
          <div class="upload-area" id="image-upload-area">
            <div class="upload-placeholder" id="image-placeholder">
              <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                <circle cx="8.5" cy="8.5" r="1.5"/>
                <polyline points="21 15 16 10 5 21"/>
              </svg>
              <p>Click to select an image</p>
              <span class="file-info">Supports JPG, PNG</span>
            </div>
            <img id="image-preview" class="image-preview" style="display: none;" />
          </div>
          <div id="color-picker-area" class="color-picker-area" style="display: none;">
            <label for="bg-color-picker">Choose Background Color:</label>
            <input type="color" id="bg-color-picker" value="#667eea">
          </div>
          <div class="image-options" id="image-options" style="display: none;">
            <label>Background Style:</label>
            <select id="background-style">
              <option value="cover">Fill (Cover)</option>
              <option value="contain">Fit (Contain)</option>
              <option value="repeat">Repeat</option>
              <option value="center">Center</option>
            </select>
          </div>
        </div>

        <div class="upload-card" id="video-preview-card">
          <div class="upload-header">
            <h2>Preview</h2>
          </div>
          <div class="video-preview-container">
            <div class="video-preview-frame" id="video-preview">
              <div class="preview-placeholder">
                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polygon points="5 3 19 12 5 21 5 3"/>
                </svg>
                <p>Preview will appear here</p>
              </div>
              <img id="preview-image" class="preview-image" style="display: none;" />
              <div class="preview-overlay" id="preview-overlay" style="display: none;">
                <h3 id="preview-title">Video Title</h3>
              </div>
            </div>
            <div class="preview-info" id="preview-info">
              <p class="preview-stat"><strong>Duration:</strong> <span id="preview-duration">--</span></p>
              <p class="preview-stat"><strong>Clips:</strong> <span id="preview-clips">0</span></p>
            </div>
          </div>
        </div>

        <div class="upload-card">
          <div class="upload-header">
            <h2>Audio Files</h2>
          </div>
          <div class="upload-area" id="audio-upload-area">
            <div class="upload-placeholder">
              <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 18V5l12-2v13"/>
                <circle cx="6" cy="18" r="3"/>
                <circle cx="18" cy="16" r="3"/>
              </svg>
              <p>Click to select audio file(s)</p>
              <span class="file-info">Supports MP3</span>
            </div>
          </div>
          <!-- Timeline Editor -->
          <div id="timeline-container" class="timeline-container" style="display: none;">
            <div class="timeline-controls">
              <button id="timeline-play" class="timeline-control-btn" title="Play/Pause (Space)">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polygon points="5 3 19 12 5 21 5 3"/>
                </svg>
              </button>
              <span id="timeline-time" class="timeline-time">00:00.000</span>
              <div class="timeline-divider"></div>
              <button id="split-clip-btn" class="timeline-control-btn" title="Split Clip at Playhead (S)" disabled>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="5" x2="12" y2="19"/>
                  <polyline points="9 8 12 5 15 8"/>
                  <polyline points="9 16 12 19 15 16"/>
                </svg>
              </button>
              <div class="timeline-divider"></div>
              <div class="timeline-zoom-controls">
                <button id="zoom-out" class="timeline-control-btn" title="Zoom Out (-)">-</button>
                <span id="zoom-level">100%</span>
                <button id="zoom-in" class="timeline-control-btn" title="Zoom In (+)">+</button>
              </div>
            </div>
            <div class="timeline-ruler" id="timeline-ruler"></div>
            <div class="timeline-tracks" id="timeline-tracks"></div>
            <div class="timeline-playhead" id="timeline-playhead"></div>
          </div>

          <!-- Legacy playlist (hidden when timeline is active) -->
          <div id="audio-playlist" class="playlist"></div>

          <div id="audio-volume-control" class="volume-control" style="display: none;">
            <label for="audio-volume">Main Audio Volume: <span id="audio-volume-value">100</span>%</label>
            <input type="range" id="audio-volume" min="0" max="100" value="100" />
          </div>
        </div>

      </div>

      <div class="actions">
        <button id="convert-btn" class="convert-btn" disabled>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="5 3 19 12 5 21 5 3"/>
          </svg>
          Convert to MP4
        </button>
        <button id="settings-btn" class="settings-btn">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"/>
            <path d="M12 1v6m0 6v6m6-12h-6m6 0h6m-6 0v6m0 6h-6m0-6H1m5-5h6"/>
          </svg>
          Settings
        </button>
      </div>

      <div id="progress-section" class="progress-section" style="display: none;">
        <div class="progress-bar-container">
          <div id="progress-bar" class="progress-bar"></div>
        </div>
        <p id="progress-text" class="progress-text">0%</p>
        <p id="progress-details" class="progress-details">Starting export...</p>
      </div>

      <div id="result-section" class="result-section" style="display: none;">
        <p id="result-message"></p>
        <div id="upload-actions" style="display: none; margin-top: 1rem;">
          <div class="form-group">
            <label for="video-title-main">Video Title</label>
            <input type="text" id="video-title-main" placeholder="My Video" value="Converted Video" />
          </div>
          <div class="form-group">
            <label>
              <input type="checkbox" id="auto-upload-main" />
              Automatically upload after conversion
            </label>
          </div>
          <button id="upload-vimeo-btn" class="secondary-btn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
              <polyline points="17 8 12 3 7 8"/>
              <line x1="12" y1="3" x2="12" y2="15"/>
            </svg>
            Upload to Vimeo
          </button>
        </div>
      </div>

      <!-- Settings Modal -->
      <div id="settings-modal" class="modal" style="display: none;">
        <div class="modal-content">
          <div class="modal-header">
            <h2>Settings</h2>
            <button id="close-modal" class="close-btn">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18"/>
                <line x1="6" y1="6" x2="18" y2="18"/>
              </svg>
            </button>
          </div>
          <div class="modal-body">
            <div class="setting-section">
              <h3>Vimeo Integration</h3>
              <p class="help-text">To upload videos to Vimeo, you need an access token:</p>
              <ol class="help-steps">
                <li>Go to <a href="https://developer.vimeo.com/apps" target="_blank">Vimeo Developer</a></li>
                <li>Create a new app or select an existing one</li>
                <li>Generate a personal access token with "Upload" scope</li>
                <li>Paste the token below</li>
              </ol>
              <div class="form-group">
                <label for="vimeo-token">Vimeo Access Token</label>
                <input type="password" id="vimeo-token" placeholder="Enter your Vimeo access token" />
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button id="save-settings" class="save-btn">Save Settings</button>
          </div>
        </div>
      </div>
    </main>
  </body>
</html>
